<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leyes de reflexión y refracción — Simulador avanzado</title>
  <meta name="description" content="Simulador avanzado de óptica para explorar la Ley de Snell, reflexión interna total, ángulo de Brewster y coeficientes de Fresnel.">
  <link rel="icon" href="../../assets/img/favicon.webp" type="image/webp">
  <link rel="stylesheet" href="./optica-leyes.css">
</head>
<body>
  <div class="container">
    <a href="../../projects.html" class="back-link">← Volver a proyectos</a>
    <h1>Leyes de reflexión y refracción — Simulador avanzado</h1>
        <p class="lead">
      Ajusta ángulos e índices, alterna <b>incidencia externa</b> (arriba→abajo) o <b>interna</b> (abajo→arriba),
      muestra un <b>transportador/compás</b>, cambia colores del láser y observa <b>RIT</b>, ángulo crítico y coeficientes
      de Fresnel (R/T). Puedes <b>arrastrar</b> el punto de incidencia sobre la interfaz y <b>guardar</b> la imagen.
    </p>


    <div class="simulator-layout">
      <!-- Canvas (ahora a la izquierda) -->
      <div class="canvas-container">
        <canvas id="scene"></canvas>
        <div class="control-card angle-control-mobile mt-1">
          <div class="form-group">
            <label id="lbl-angleDegMobile" for="angleDegMobile">Ángulo de incidencia θᵢ (°)</label>
            <input type="range" id="angleDegMobile" min="0" max="89.9" step="0.1" aria-labelledby="lbl-angleDegMobile">
            <input type="number" id="angleDegNumMobile" min="0" max="89.9" step="0.1" aria-labelledby="lbl-angleDegMobile">
          </div>
        </div>
        <p class="helper-text">
          Consejo: prueba con n₁ &gt; n₂ y aumenta θᵢ hasta superar θc para observar <em>reflexión interna total</em>.
          Arrastra el punto de incidencia a lo largo de la interfaz.
        </p>
        <div class="control-card mt-1">
          <h2>Lecturas</h2>
          <ul class="results-list" id="resultsList">
            <li>θᵢ = <b id="resThI">—</b>°, θʳ = <b id="resThR">—</b>° | θᵗ = <b id="resThT">—</b>°</li>
            <li>θc = <b id="resThC">—</b>°</li>
            <li>θᴮ (Brewster) = <b id="resThB">—</b>°</li>
            <li>R (Fresnel) ≈ <b id="resR">—</b>% | T ≈ <b id="resT">—</b>% <span id="resTIR"></span></li>
          </ul>
          <div class="action-buttons">
            <button id="saveBtn" class="btn">Guardar PNG</button>
            <button id="resetBtn" class="btn">Reset</button>
            <button id="themeToggleBtn" class="btn" aria-label="Cambiar tema">🌓</button>
          </div>
        </div>
      </div>

      <!-- Controles (ahora a la derecha) -->
      <div class="controls-sidebar">
      <!-- Columna 1: materiales -->
      <div class="control-card">
        <h2>Medios</h2>
        <div class="form-group">
          <label for="topMat">Medio superior</label>
          <select id="topMat"></select>
          <label id="nTopCustomLabel" for="nTopCustom" class="sub-label hidden">Índice (n) personalizado</label>
          <input type="number" id="nTopCustom" min="1" step="0.01" class="hidden mt-05" placeholder="1.50">
        </div>
        <div class="form-group">
          <label for="botMat">Medio inferior</label>
          <select id="botMat"></select>
          <label id="nBotCustomLabel" for="nBotCustom" class="sub-label hidden">Índice (n) personalizado</label>
          <input type="number" id="nBotCustom" min="1" step="0.01" class="hidden mt-05" placeholder="1.00">
        </div>
        <div class="form-group">
          <label>Modo de incidencia</label>
          <div class="toggle-group" id="fromTopToggle" role="group" aria-label="Modo de incidencia">
            <button data-value="true" class="active" aria-pressed="true">Externa ↑↓</button>
            <button data-value="false" aria-pressed="false">Interna ↓↑</button>
          </div>
        </div>
      </div>

      <!-- Columna 2: ángulo y estilo -->
      <div class="control-card">
        <h2>Rayo y Ángulos</h2>
        <div class="form-group angle-control-desktop">
          <label id="lbl-angleDeg" for="angleDeg">Ángulo de incidencia θᵢ (°)</label>
          <input type="range" id="angleDeg" min="0" max="89.9" step="0.1" aria-labelledby="lbl-angleDeg">
          <input type="number" id="angleDegNum" min="0" max="89.9" step="0.1" aria-labelledby="lbl-angleDeg">
        </div>
        <div class="form-group">
          <label>Colores</label>
          <div class="color-inputs">
            <label>Incidente <input type="color" id="colorIncident" aria-label="Color del rayo incidente"></label>
            <label>Reflejado <input type="color" id="colorReflected" aria-label="Color del rayo reflejado"></label>
            <label>Transmitido <input type="color" id="colorTransmitted" aria-label="Color del rayo transmitido"></label>
          </div>
        </div>
        <div class="form-group">
          <label for="rayWidth">Grosor del rayo (<span id="rayWidthVal"></span>px)</label>
          <input type="range" id="rayWidth" min="1" max="6" step="0.5">
        </div>
        <div class="form-group flags-row">
          <label><input type="checkbox" id="showProtractor"> Transportador</label>
          <label><input type="checkbox" id="showLabels"> Etiquetas</label>
          <label><input type="checkbox" id="showArcs"> Arcos θ</label>
        </div>
      </div>

    </div>
    <!-- Notas teóricas -->
    <div class="notes-card">
      <h3>Notas rápidas</h3>
      <ul>
        <li>Ley de Snell: n₁·sin(θᵢ) = n₂·sin(θᵗ). La reflexión especular cumple θʳ = θᵢ.</li>
        <li>Ángulo crítico (si n₁ > n₂): θc = arcsin(n₂/n₁). Para θᵢ ≥ θc, ocurre <b>RIT</b>.</li>
        <li>Ángulo de Brewster: tan(θᴮ) = n₂/n₁ ⇒ Rₚ = 0 (para polarización p).</li>
        <li>Coeficientes de Fresnel (no polarizado) dan la fracción de intensidad reflejada (R) y transmitida (T).</li>
      </ul>
    </div>
  </div>

  <script src="./optica-leyes.js"></script>
</body>
</html>
